import { Callout } from "nextra/components";

---

# 🌳 Understanding the Virtual DOM in React

Welcome! Ever wondered how React makes your apps so fast and smooth? The secret is the Virtual DOM. Let's explore how it works, why it matters, and how it compares to vanilla JavaScript. 🚀

---

## 🐢 Is the DOM Really Slow?

<Callout type="info">
  The DOM itself isn't slow! But when web apps get interactive and the browser
  has to repaint the whole UI often, things can feel sluggish.
</Callout>

- The DOM is fast if used properly.
- Performance issues come from frequent, unnecessary repaints—not the DOM itself.

---

## 🖼️ How Does the Browser Render the DOM?

When a browser gets your HTML and CSS:

1. It parses HTML and CSS into a **DOM Tree** and **CSSOM** (style rules).
2. These combine into a **Render Tree**.
3. The browser calculates layout and then paints everything on the screen.

<Callout type="warning">
  If the browser has to repaint the whole page often, performance drops!
</Callout>

---

## 🍎 Vanilla JS vs React: DOM Repaint Example

Let's see how adding fruits to a list works in both Vanilla JS and React.

### 🍌 Vanilla JavaScript Example

```js
Array.prototype.myPush = function (...a) {
  this.push(a[0]);
  init();
};

const display = document.getElementById("fruits");
const button = document.querySelector("#button");

let fruits = ["mango", "guava", "apple", "oragne"];

const init = function () {
  document.getElementById("fruits").innerHTML = "";
  fruits.sort().forEach((fruit) => {
    let item = document.createElement("li");
    item.textContent = fruit;
    document.getElementById("fruits").appendChild(item);
  });
};

const addItem = function () {
  fruits.myPush(document.getElementById("input").value);
};

init();
```

**HTML:**

```html
<ul id="fruits"></ul>
<input type="text" id="input" />
<button id="button" onclick="addItem()">Add Item</button>
```

<Callout type="info">
  Every time you add a fruit, the whole list is rebuilt and repainted—even if
  only one item changed!
</Callout>

---

### 🧬 What is Prototype in JavaScript?

Every JavaScript object has a prototype. You can add methods to built-in objects (like Array) via their prototype. In the example above, we added a custom `myPush` method to Array.

<Callout type="warning">
  Modifying built-in prototypes is not recommended in production, but it's
  useful for learning!
</Callout>

---

## ⚡ What is Virtual DOM? How Does It Work?

Virtual DOM is at the heart of React. It helps React update only what's needed, making your app fast and efficient.

- React batches updates and minimizes DOM manipulation.
- Only the changed parts of the UI are updated.

### 🍇 React Example

```jsx
const Fruits = () => {
  const [fruit, setFruit] = React.useState("");
  const [fruits, setFruits] = React.useState([
    "mango",
    "guava",
    "apple",
    "oragne",
  ]);

  return (
    <div className="container">
      <ul id="fruits">
        {fruits.sort().map((fruit, index) => (
          <li key={index}>{fruit}</li>
        ))}
      </ul>
      <br />
      <p>
        <input
          type="text"
          value={fruit}
          onChange={(e) => setFruit(e.target.value)}
        />
      </p>
      <button onClick={() => setFruits([...fruits, fruit])}>Add Item</button>
    </div>
  );
};

ReactDOM.render(<Fruits />, document.getElementById("root"));
```

<Callout type="success">
  React only updates the part of the DOM that changed—no full repaint!
</Callout>

When you interact with the UI, React:

1. Creates a copy of the UI in its Virtual DOM.
2. Uses a smart algorithm (Diffing/Reconciliation) to find what changed.
3. Updates only the changed part in the real DOM.

---

## 🖼️ Visualizing Virtual DOM vs Real DOM

![virtual dom](../../../../../public/virtual_dom.JPG)

_Diagram: React creates a Virtual DOM, compares it to the previous version, and only updates the changed parts in the Real DOM._

<Callout type="info">
  The Virtual DOM acts as a middle layer—React compares the new Virtual DOM to
  the old one, finds the differences, and updates only what's needed in the real
  DOM. This is what makes React so efficient!
</Callout>

---

## 🏁 Quick Recap: Why Virtual DOM Matters

- Vanilla JS: Direct DOM manipulation can cause slow, unnecessary repaints.
- React: Virtual DOM updates only what's needed, making apps fast and efficient.

<Callout type="info">
  The Virtual DOM is the secret sauce behind React's speed! 🚀
</Callout>

---

## 👉 Next Steps

- Try building your own list app in React!
- Explore more about how React's rendering works in the <a href="https://react.dev/">official React docs</a>.
